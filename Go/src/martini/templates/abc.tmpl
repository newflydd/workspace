<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
        <title>{{.title}}-库存查询</title>
        <!-- 引入 WeUI -->
        <link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/1.1.2/weui.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/dna.js/1.2/dna.css"/>
    </head>
    <body>
		<div class="header" style="padding: 40px;background-color: #009291;color: #fff;">
			<div style="font:800 32px '微软雅黑';border-bottom:2px solid #fff">赛洋机电&nbsp;&nbsp;</div>
			<div style="display: inline-block;font:italic 26px '楷体';margin-left: 50px">用心为您服务</div>
		</div>
		<div class="weui-cells__title">操作者：{{.nickname}}</div>
		<div class="weui-cells__title">数据更新时间：{{.updatetime}}</div>
		<div class="weui-cells weui-cells_form">
		    <div class="weui-cell">
		        <div class="weui-cell__hd"><label class="weui-label">物品编码</label></div>
		        <div class="weui-cell__bd">
		            <input id="inp_fnumber" class="weui-input" type="text" pattern="([0-9]|.)*" placeholder="请输入K3系统内物品编号，精确匹配"/>
		        </div>
		    </div>
		    <div class="weui-cell">
		        <div class="weui-cell__hd"><label class="weui-label">物料名称</label></div>
		        <div class="weui-cell__bd">
		            <input id="inp_fname" class="weui-input" type="text" pattern="([0-9]|.)*" placeholder="K3物料名称，模糊匹配"/>
		        </div>
		    </div>
		    <div class="weui-cell">
		        <div class="weui-cell__hd"><label class="weui-label">仓库名称</label></div>
		        <div class="weui-cell__bd">
		            <input id="inp_fstockname" class="weui-input" type="text" pattern="([0-9]|.)*" placeholder="K3仓库名称，模糊匹配"/>
		        </div>
		    </div>
		</div>
		
        <a id="btn_search" style="margin:5px" href="javascript:;" class="weui-btn weui-btn_primary">查询</a>

        <div id="container" class="dna-template">
			<div class="weui-panel">
			    <div class="weui-panel__bd">
			        <div class="weui-media-box weui-media-box_text">
			            <h4 class="weui-media-box__title">~~fname~~</h4>
						<p class="weui-media-box__desc">~~fnumber~~</p>
			            <p class="weui-media-box__desc">库存：<span>~~fqty~~</span><span>~~funitname~~</span></p>
						<p class="weui-media-box__desc">
							型号：<span>~~fmodel~~</span>&nbsp;|&nbsp;<span>~~fstockname~~</span>
						</p>			           
			        </div>
			    </div>
			</div>
        </div>

        <div class="weui-footer">
		    <p class="weui-footer__text" style="margin-top: 20px">Copyright &copy; 2001-2017 saiyang.com.cn</p>
		</div>

        <div id="div_loadingToast" style="display:none;">
		    <div class="weui-mask_transparent"></div>
		    <div class="weui-toast">
		        <i class="weui-loading weui-icon_toast"></i>
		        <p class="weui-toast__content">数据加载中</p>
		    </div>
		</div>
        <script type="text/javascript" src="https://ojtkyre9w.qnssl.com/resources/js/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/dna.js/1.2/dna.min.js"></script>
        <script type="text/javascript">
        	$(function(){
        		$("#btn_search").click(function(){
        			$.ajax({
			            type : "get",
			            url  : "/api/getStoreData",
			            data : {"fnumber": $("#inp_fnumber").val(), "fname": $("#inp_fname").val(), "fstockname": $("#inp_fstockname").val()},
						beforeSend	: function(){
							$("#div_loadingToast").show();
						},
						success : function(results){
							/* 处理数组，迭代添加dom模型 */	
							dna.empty('container', { fade: false });							
							dna.clone('container', results);

							$("#div_loadingToast").hide();
						},
						timeout: 5000,
			            error: function(XMLHttpRequest){
			            	$("#div_loadingToast").hide();
			            	alert(XMLHttpRequest.responseText);
			            },
			            dataType : "json"
			         });
        		});
        	});
        </script>
    </body>
</html>
